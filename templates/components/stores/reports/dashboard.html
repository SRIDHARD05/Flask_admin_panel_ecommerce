{% extends '__master.html' %}
{% block content %}
<div class="container-fluid py-2">
    <br>
    <div id="download-products-data" class="btn btn-primary btn-rounded">Download Products Data</div>
    <div class="vendors-data">vendorsList -> {{data.vendors}}</div>
    <br>
    <div class="tags">tags -> {{data.tags}}</div>
    <br>
    <div class="product-types">Products Types ->
        {{data.product_types}}
    </div>
    <br>
    <div class="total-products">Total Products -> {{data.total_products}}</div>
    <br>
    <div class="keywords">keywords -> {{data.keywords}}</div>
    <br>
    <div class="average-price">Average Proce -> {{data.average_price}}</div>
    <br>
    <div class="max-price">Max Price -> {{data.max_price}}</div>
    <br>
    <div class="min-price">Min Proice -> {{data.min_price}}</div>
    <br>
    <div class="first-modified">First Modified Date -> {{data.first_modified}}</div>
    <br>
    <div class="last-modified">Last Modified Date -> {{data.last_modified}}</div>
    <br>
    <div class="last-6-months">Last 6 Months -> {{data.last_6_months}}</div>
    <br>
    <div class="last-12-months">Last 12 Months -> {{data.last_12_months}}</div>
    <br>
    <!-- TODO: Add Implementations for extracting the Shpoify installed Apps -->
    <br>
    <div class="data-applications">Installed Apps -> {{data.data_application}}</div>
    <br>
    <div class="regions">Region -> {{data.data_render_region}}</div>
    <br>
    <div class="store-title">Store Title -> {{data.title}}</div>
    <br>
    <div class="store-desciptions">Store Descriptions -> {{data.description}}</div>
    <br>
    <div class="store-url">Store URL -> {{data.shop_url}}</div>
    <br>
    <div class="locations">Store Locations -> {{data.locale}}</div>
    <br>
    <div class="currency">Currency -> {{data.currency}}</div>
    <br>
    <div class="country">country -> {{data.country}}</div>
    <br>
    <div class="theme">Theme -> {{data.theme}}</div>
    <br>
    <div class="shop-id">Shop Id -> {{data.shop_id}}</div>
    <br>
    <div class="montly-sales">Montly Sales -> {{data.monthly_sales}}</div>
    <br>
    <div class="montly-visits">Montly Visits -> {{data.monthly_visits}}</div>
    <br>
    <div class="social-links">social-links -> {{data.social_links}}</div>
    <br>
    <br>
    {{data.best_seller_products}}
    <br><br>

</div>
<script type="application/javascript">
    var product_datas = {{ product_data | safe }};
    var store_url = "{{ data.shop_url | safe }}";
    console.log(product_datas);
    $(document).ready(function () {
        $("#download-products-data").on('click', function () {
            const jsonString = JSON.stringify(product_datas, null, 4);
            const blob = new Blob([jsonString], { type: 'application/json' });

            const link = document.createElement('a');

            link.href = URL.createObjectURL(blob);
            link.download = `${store_url}-product_data.json`;
            
            document.body.appendChild(link);
            link.click(); document.body.removeChild(link);
        });
    });
</script>

{% endblock %}